<#
Este é um script PowerShell
---------------------------------------------------------------------------------
Nome do arquivo de script: DominioAutomatizado.ps1
Descrição: Esse script automatiza três etapas essenciais no gerenciamento de 
           computadores via Active Directory: ele ingressa a máquina no domínio, 
           move o objeto para a Unidade Organizacional (OU) definida e adiciona 
           o computador ao grupo especificado, garantindo que a estrutura 
           hierárquica e as políticas de segurança sejam aplicadas corretamente. 
           Compatível em ambiente MS Windows (PowerShell 5.1 e 7+).
Autor: Denilly Carvalho do Carmo
Data de Criação: 11/12/2025
Projeto: https://github.com/denilly/Dominio-automatizado-win
Copyright (c) 2025 Denilly Carvalho do Carmo. Todos os direitos reservados.
Licença: GNU General Public License (GPL) versão 3
Versão: 1.0

NOTAS: Este script é fornecido "como está" e pode ser utilizado e modificado por 
terceiros, desde que os créditos ao autor sejam mantidos. Para uso em projetos, 
por favor, faça referência a este script e ao autor.

IMPORTANTE: Execute este script diretamente e abrirá uma interface gráfica
            com os campos necessários para preenchimento. Opcionalmente, este 
            script poderá ser empacotado em .EXE (ex.: auto-py-to-exe).

COMO USAR:
1. Crie o arquivo do script com o seu editor preferido usando codificação de caracteres UTF-8
#    com BOM para compatibilidade com Powershell 5.1 e 7+:
#    > notepad C:\path\to\script\DominioAutomatizado.ps1
# 2. Cole o código deste arquivo no editor, ajustes os parâmetros comentados com "<--" (quando  
#    necessário) e salve o arquivo.
# 3. Checar políticas de execução de scripts no PowerShell, e, se necessário, ajustar conforme 
#    política interna:
#    > Get-ExecutionPolicy -List
#    > Set-ExecutionPolicy -Scope LocalMachine -ExecutionPolicy RemoteSigned -Force
# 4. Execute o script:
#    > .\DominioAutomatizado.ps1
---------------------------------------------------------------------------------
#>
#  1. ===================== CONFIGURAÇÕES GERAIS - AJUSTE CONFORME AMBIENTE =====================
$ScriptVersion = '1.0'
$ScriptRevision = '11/12/2025'
$LicencaGPL = 'GPL-3.0'

# Títulos do Formulário
$TextForm = "Domínio Automatizado v" + $ScriptVersion # <--
$TextFormTitle = "Domínio Automatizado v" + $ScriptVersion # <--

# Logo e ícone de janela no formato Base 64 (para gerar a codificaçao use => https://base64.guru/converter/encode/image)
$logoBase64 = "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" # <-- Cole aqui o base64 do logo
$iconBase64 = "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" # <-- Cole aqui o base64 do ícone

# Informe o domínio padrão para conexão e busca LDAP
$domainFQDN = "exemplo.local" # <--

# ----------------------------------------------------------------------------------------------
# Controle de permissionamento dos campos do formulário (0 = desabilitado e 1 = habilitado)
# ----------------------------------------------------------------------------------------------
# Campos Domínio e Tipo de Equipamento
$domainTxtBoxEnable = 0 # <--
$tipoCBoxEnable     = 1 # <--

# ----------------------------------------------------------------------------------------------
# Mapeamento dos itens das Comboboxes
# ----------------------------------------------------------------------------------------------
# Cria uma coleção de pares chave/valor que mantém a ordem de inserção
$OUMap       = [System.Collections.Specialized.OrderedDictionary]::new()
$clienteMap  = [System.Collections.Specialized.OrderedDictionary]::new()
$servidorMap = [System.Collections.Specialized.OrderedDictionary]::new()

# ----------------------------------------------------------------------------------------------
# Informe a seguir as Bases DN e os grupos associados para mapeamento dos itens das Comboboxes 
# de cada tipo de computador (Cliente e Servidor)
# ----------------------------------------------------------------------------------------------
# ----------------
# Tipo: Cliente
# ----------------
# Cliente - Item 1 <--
$clienteMap.Add("DIR/FINANCEIRO", @{
    "DN"    = "OU=FINANCEIRO,OU=DIRETORIA-GERAL,OU=EMPRESA,DC=exemplo,DC=local"
    "Grupo" = "GRP-FIN"
})

# Cliente - Item 2 <--
$clienteMap.Add("DIR/TIC", @{
    "DN"    = "OU=TIC,OU=DIRETORIA-GERAL,OU=EMPRESA,DC=exemplo,DC=local"
    "Grupo" = "GRP-TIC"
})

# Cliente - Item 3 <--
<# Exemplo
$clienteMap.Add("DIR/RH", @{
    "DN"    = "OU=RH,OU=DIRETORIA-GERAL,OU=EMPRESA,DC=exemplo,DC=local"
    "Grupo" = "GRP-RH"
})
Exemplo #>

# Cliente - Item 4 <--
<# Exemplo
$clienteMap.Add("OPE/PRODUCAO", @{
    "DN"    = "OU=PRODUCAO,OU=OPERACIONAL,OU=EMPRESA,DC=exemplo,DC=local"
    "Grupo" = "GRP-PROD"
})
Exemplo #>
#
# ----------------
# Tipo: Servidor
# ----------------
# Servidor - Item 1 <--
$servidorMap.Add("SRV-WIN-PROD", @{
    "DN"    = "OU=Windows,OU=Produção,OU=Servidores,OU=TIC,OU=DIRETORIA-GERAL,OU=EMPRESA,DC=exemplo,DC=local"
    "Grupo" = "GRP-SRV-PROD"
})

# Servidor - Item 2 <--
$servidorMap.Add("SRV-WIN-HOMOLOG", @{
    "DN"    = "OU=Windows,OU=Homologação,OU=Servidores,OU=TIC,OU=DIRETORIA-GERAL,OU=EMPRESA,DC=exemplo,DC=local"
    "Grupo" = "GRP-SRV-HML"
})

<# Exemplo
# Servidor - Item 3 <--
$servidorMap.Add("SRV-WIN-SERVICOS", @{
    "DN"    = "OU=Windows,OU=Serviços,OU=Servidores,OU=TIC,OU=DIRETORIA-GERAL,OU=EMPRESA,DC=exemplo,DC=local"
    "Grupo" = "GRP-SRV-SVC"
})
Exemplo #>

# ----------------------------------------------------------------------------------------------
# Não altere a partir daqui!!!
# ----------------------------------------------------------------------------------------------
$OUMap.Add("Cliente", $clienteMap)
$OUMap.Add("Servidor", $servidorMap)

Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing

$ErrorActionPreference = 'Stop'

# Obtém o hostname atual
$computerName = $env:COMPUTERNAME

# 2. ==================== EMBUTIR LOGO E ÍCONE (inclui a base64 da imagem e ícone) ====================

function Get-Image($b64) {
    if ($b64.Length -gt 100) {
        $bytes = [Convert]::FromBase64String($b64)
        $ms = New-Object IO.MemoryStream(,$bytes)
        return [Drawing.Image]::FromStream($ms)
    }
    return $null
}
function Get-Icon($b64) {
    if ($b64.Length -gt 100) {
        $bytes = [Convert]::FromBase64String($b64)
        $ms = New-Object IO.MemoryStream(,$bytes)
        return [Drawing.Icon]::new($ms)
    }
    return $null
}

# 3. ==================== FUNÇÕES DE LOG E SUPORTE ====================
# Função Log com Cor (verde para sucesso, vermelho para erro)
function Log {
    param($Message, $Color = "Lime")

    $col = switch ($Color) {
        "Red"    { [System.Drawing.Color]::Red }
        "Yellow" { [System.Drawing.Color]::Yellow }
        "Cyan"   { [System.Drawing.Color]::Cyan }
        "Lime"   { [System.Drawing.Color]::Lime }
        default  { [System.Drawing.Color]::Lime }
    }

    $t = "[$(Get-Date -Format HH:mm:ss)] $Message"
    $logBox.SelectionStart = $logBox.TextLength
    $logBox.SelectionLength = 0
    $logBox.SelectionColor = $col
    $logBox.AppendText("$t`r`n")
    $logBox.SelectionColor = $logBox.ForeColor
    $logBox.ScrollToCaret()
}

# Teste rápido LDAPS
function Test-LdapsFast {
    param(
        [string]$TargetHost,
        [int]$Port = 636,
        [int]$TimeoutMs = 1500
    )
    try {
        $client = New-Object System.Net.Sockets.TcpClient
        $async  = $client.BeginConnect($TargetHost, $Port, $null, $null)
        if (-not $async.AsyncWaitHandle.WaitOne($TimeoutMs, $false)) {
            $client.Close()
            return $false
        }
        $client.EndConnect($async)
        $client.Close()
        return $true
    } catch { return $false }
}

# 4. ==================== FORMULÁRIO ====================
$form = New-Object System.Windows.Forms.Form
$form.Text = $TextForm
$form.Size = [System.Drawing.Size]::new(520, 780)
$form.StartPosition = "CenterScreen"
$form.FormBorderStyle = "FixedDialog"
$form.MaximizeBox = $false
$form.BackColor = [System.Drawing.Color]::FromArgb(245, 245, 245)  # Fundo cinza claro suave
$form.Icon = Get-Icon $iconBase64

# Painel Cabeçalho
$headerPanel = New-Object System.Windows.Forms.Panel
$headerPanel.Location = [System.Drawing.Point]::new(0, 0)
$headerPanel.Size = [System.Drawing.Size]::new(520, 170)
$headerPanel.BackColor = [System.Drawing.Color]::White
$headerPanel.BorderStyle = "None"
$form.Controls.Add($headerPanel)

# Logo
$logo = New-Object System.Windows.Forms.PictureBox
$logo.Image = Get-Image $logoBase64
$logo.SizeMode = "Zoom"
$logo.Location = [System.Drawing.Point]::new(170, 15)
$logo.Size = [System.Drawing.Size]::new(180, 90)
$headerPanel.Controls.Add($logo)

# Título
$title = New-Object System.Windows.Forms.Label
$title.Text = $TextFormTitle
$title.Font = [System.Drawing.Font]::new("Segoe UI", 16, [System.Drawing.FontStyle]::Bold)
$title.ForeColor = [System.Drawing.Color]::FromArgb(0, 120, 215)  # Azul profissional
$title.TextAlign = "MiddleCenter"
$title.Location = [System.Drawing.Point]::new(0, 120)
$title.Size = [System.Drawing.Size]::new(520, 40)
$headerPanel.Controls.Add($title)

# Linha Separadora
$divider = New-Object System.Windows.Forms.Label
$divider.BackColor = [System.Drawing.Color]::FromArgb(200, 200, 200)
$divider.Location = [System.Drawing.Point]::new(30, 170)
$divider.Size = [System.Drawing.Size]::new(460, 1)
$form.Controls.Add($divider)

# Painel Campos
$fieldsPanel = New-Object System.Windows.Forms.Panel
$fieldsPanel.Location = [System.Drawing.Point]::new(0, 180)
$fieldsPanel.Size = [System.Drawing.Size]::new(520, 280)
$fieldsPanel.BackColor = [System.Drawing.Color]::Transparent
$form.Controls.Add($fieldsPanel)

# 5. ==================== CAMPOS ====================
$labels = @(
    "Domínio do AD:",
    "Tipo de Equipamento:",
    "Unidade Organizacional (OU):",
    "Usuário (dominio\login ou login@dominio):",
    "Senha AD:"
)
$y = 5
$h = 35
$textBoxes = @()

foreach ($txt in $labels) {

    # Label
    $lbl = New-Object System.Windows.Forms.Label
    $lbl.Text = $txt
    $lbl.Location = New-Object System.Drawing.Point(30, $y)
    $lbl.Size = New-Object System.Drawing.Size(230, $h)
    $lbl.Font = New-Object System.Drawing.Font("Segoe UI", 9)
    $lbl.ForeColor = [System.Drawing.Color]::FromArgb(80, 80, 80)
    $fieldsPanel.Controls.Add($lbl)

    # Caixa de entrada / Combobox
    if ($txt -like "Tipo de Equipamento*") {

        # ComboBox para Tipo de Equipamento
        $cbTipo = New-Object System.Windows.Forms.ComboBox
        $cbTipo.Location = New-Object System.Drawing.Point(260, $y)
        $cbTipo.Size = New-Object System.Drawing.Size(220, $h)
        $cbTipo.Font = New-Object System.Drawing.Font("Segoe UI", 9)
        $cbTipo.FlatStyle = "Popup"
        $cbTipo.DropDownStyle = 'DropDownList'
        # No PowerShell 7 o AddRange não aceita diretamente o KeyCollection do Hashtable,
        # portanto convertemos as chaves explicitamente para string[] usando "@" para 
        # manter compatibilidade com PS5 e PS7.
        $cbTipo.Items.AddRange(@($OUMap.Keys))
        $cbTipo.SelectedIndex = 0
        $fieldsPanel.Controls.Add($cbTipo)
        # Tooltip
        $toolTipCbTipo = New-Object System.Windows.Forms.ToolTip
        $toolTipCbTipo.SetToolTip($cbTipo, "Informe se o computador é do tipo cliente (ex.: MS Windows 11) ou servidor (ex.: MS Windows Server 2022).")

    } elseif ($txt -like "Unidade Organizacional*") {

        # Combobox de OU
        $cbOU = New-Object System.Windows.Forms.ComboBox
        $cbOU.Location = New-Object System.Drawing.Point(260, $y)
        $cbOU.Size = New-Object System.Drawing.Size(220, $h)
        $cbOU.Font = New-Object System.Drawing.Font("Segoe UI", 9)
        $cbOU.FlatStyle = "Popup"
        $cbOU.DropDownStyle = 'DropDownList'
        $cbOU.Items.AddRange(@($OUMap[$cbTipo.SelectedItem].Keys))
        $cbOU.SelectedIndex = 0
        $fieldsPanel.Controls.Add($cbOU)
        # Cria Tooltip do campo OU
        $toolTipCbOU = New-Object System.Windows.Forms.ToolTip
        $toolTipCbOU.SetToolTip($cbOU, "Informe a posição no organograma ou o ambiente, conforme o tipo de equipamento (cliente ou servidor).")

    } else {

        # TextBox padrão
        $tb = New-Object System.Windows.Forms.TextBox
        $tb.Location = New-Object System.Drawing.Point(260, $y)
        $tb.Size = New-Object System.Drawing.Size(220, $h)
        $tb.Font = New-Object System.Drawing.Font("Segoe UI", 9)
        $tb.BackColor = "White"
        $tb.BorderStyle = "FixedSingle"
        if ($txt -like "*Senha*") { $tb.UseSystemPasswordChar = $true }
        $fieldsPanel.Controls.Add($tb)
        $textBoxes += $tb

        # Tooltip
        $toolTip = New-Object System.Windows.Forms.ToolTip
        $toolTip.SetToolTip($tb, $txt.Replace(":", "") + " é obrigatório.")
    }

    $y += 46
}

# Valor padrão para o campo "Domínio"
$textBoxes[0].Text = $domainFQDN

# Cria o comportamento dinâmico entre os combos
$cbTipo.Add_SelectedIndexChanged({
    $tipoSelecionado = $cbTipo.SelectedItem

    # Evita erro caso o usuário clique rápido demais
    if (-not $tipoSelecionado) { return }

    # Limpa o combo de OU
    $cbOU.Items.Clear()

    # Carrega apenas as OUs daquele tipo
    $cbOU.Items.AddRange([string[]]$OUMap[$tipoSelecionado].Keys)

    # Seleciona automaticamente o primeiro item
    if ($cbOU.Items.Count -gt 0) {
        $cbOU.SelectedIndex = 0
    }
})

# Campo "Domínio" e "Tipo de Equipamento" podem ser bloqueados para edição
$textBoxes[0].Enabled = $domainTxtBoxEnable
$cbTipo.Enabled       = $tipoCBoxEnable

# Checkbox
$y += 10
$chkRestart = New-Object System.Windows.Forms.CheckBox
$chkRestart.Text = "Reiniciar automaticamente após concluir (recomendado)"
$chkRestart.Checked = $true
$chkRestart.Location = [System.Drawing.Point]::new(30, $y)
$chkRestart.Size = [System.Drawing.Size]::new(460, $h)
$chkRestart.Font = [System.Drawing.Font]::new("Segoe UI", 10)
$chkRestart.ForeColor = [System.Drawing.Color]::FromArgb(80, 80, 80)
$chkRestart.FlatStyle = "Popup"
$chkRestart.AutoSize = $false
$fieldsPanel.Controls.Add($chkRestart)

# Botão
$y = 460
$btn = New-Object System.Windows.Forms.Button
$btn.Text = "INGRESSAR NO DOMÍNIO"
$btn.BackColor = [System.Drawing.Color]::FromArgb(0, 120, 215)
$btn.ForeColor = [System.Drawing.Color]::White
$btn.Font = [System.Drawing.Font]::new("Segoe UI", 12, [System.Drawing.FontStyle]::Bold)
$btn.FlatStyle = "Flat"
$btn.FlatAppearance.BorderSize = 0
$btn.Location = [System.Drawing.Point]::new(110, $y)
$btn.Size = [System.Drawing.Size]::new(280, 50)
$btn.Add_MouseEnter({ $this.BackColor = [System.Drawing.Color]::FromArgb(0, 100, 195) })  # Hover effect
$btn.Add_MouseLeave({ $this.BackColor = [System.Drawing.Color]::FromArgb(0, 120, 215) })
$form.Controls.Add($btn)

# Barra de Progresso
$y += 60
$progressBar = New-Object System.Windows.Forms.ProgressBar
$progressBar.Location = [System.Drawing.Point]::new(30, $y)
$progressBar.Size = [System.Drawing.Size]::new(450, 20)
$progressBar.Style = "Continuous"
$progressBar.ForeColor = [System.Drawing.Color]::FromArgb(0, 120, 215)
$form.Controls.Add($progressBar)

# Log
$y += 30
$logBox = New-Object System.Windows.Forms.RichTextBox
$logBox.Location = [System.Drawing.Point]::new(30, $y)
$logBox.Size = [System.Drawing.Size]::new(450, 180)
$logBox.Multiline = $true
$logBox.ReadOnly = $true
$logBox.ScrollBars = "Vertical"
$logBox.Font = [System.Drawing.Font]::new("Consolas", 9.5)
$logBox.BackColor = [System.Drawing.Color]::FromArgb(30,30,30)
$logBox.ForeColor = [System.Drawing.Color]::Lime
$logBox.BorderStyle = "FixedSingle"
$form.Controls.Add($logBox)

# Joga o cursor para o campo "Usuário" ao término da criação do formulário e quando este já está visível
$form.Add_Shown({
    $textBoxes[1].Focus()
})

# ==================== EVENTO PRINCIPAL ====================
$btn.Add_Click({
    $btn.Enabled = $false
    $progressBar.Value = 0
    try {
        $domainFQDN    = $textBoxes[0].Text.Trim()
        $user          = $textBoxes[1].Text.Trim()
        $pass          = $textBoxes[2].Text
        $targetOU      = $OUMap[$cbTipo.SelectedItem][$cbOU.SelectedItem]["DN"]
        $targetGroupCN = $OUMap[$cbTipo.SelectedItem][$cbOU.SelectedItem]["Grupo"]

        if ([string]::IsNullOrEmpty($user) -or [string]::IsNullOrEmpty($pass)) {
            throw "Preencha os campos obrigatórios!"
        }

        $progressBar.Value = 10

        # Gera o domainRoot a partir do domainFQDN
        $domainRoot = (($domainFQDN -split '\.') | ForEach-Object { "DC=$_" }) -join ','

        Log "Iniciando processo para $env:COMPUTERNAME..."

        # 1. Descobre DC
        Log "Consultando DNS para DCs em $domainFQDN..." "Cyan"
        $srvRecords = Resolve-DnsName -Name "_ldap._tcp.dc._msdcs.$domainFQDN" -Type SRV -ErrorAction SilentlyContinue | Where-Object { $_.Type -eq 'SRV' } | Sort-Object Priority, { - $_.Weight }
        $DCList = $srvRecords | Select-Object -ExpandProperty NameTarget -ErrorAction SilentlyContinue

        Log "Selecionando DC disponível via LDAPS..." "Cyan"

        $SelectedDC = $null
        foreach ($dc in $DCList) {
            Log "Testando LDAPS em $dc ..." "Cyan"
            if (Test-LdapsFast -TargetHost $dc) {
                Log "LDAPS OK em $dc"
                $SelectedDC = $dc
                break
            } else {
                Log "LDAPS não respondeu em $dc" "Red"
            }
        }

        if (-not $SelectedDC) {
            throw "Nenhum DC respondeu LDAPS. Verifique DNS/rede."
        }

        $progressBar.Value = 20

        # 2. Preparar credenciais
        $SecurePassword = ConvertTo-SecureString $pass -AsPlainText -Force
        $Cred = New-Object System.Management.Automation.PSCredential($user, $SecurePassword)

        # 3. Ingressar no domínio
        Log "Ingressando '$computerName' no domínio '$DomainName' via DC '$SelectedDC'..." "Cyan"
        Add-Computer -DomainName $domainFQDN -Server $SelectedDC -Credential $Cred -ErrorAction Stop -Force
        Log "Ingresso concluído!" "Lime"

        $progressBar.Value = 40

        # 4. Move para OU
        Log "Aguardando tempo de replicação local do DC... (5 segundos)" "Cyan"
        Start-Sleep -Seconds 5

        $progressBar.Value = 60

        Log "Movendo '$computerName' para a OU selecionada..." "Cyan"

        # Cria o DirectoryEntry para a raiz do domínio com credenciais e DC
        $root = New-Object System.DirectoryServices.DirectoryEntry("LDAP://$SelectedDC/$DomainRoot", $user, $pass)

        # Cria um searcher com o root especificado
        $compSearcher = New-Object System.DirectoryServices.DirectorySearcher
        $compSearcher.SearchRoot = $root
        $compSearcher.Filter = "(&(objectCategory=computer)(name=$computerName))"
        $compSearcher.SearchScope = "Subtree"
        $compSearcher.PropertiesToLoad.Add("distinguishedName") | Out-Null

        # Executa a busca
        $compResult = $compSearcher.FindOne()

        if ($compResult -ne $null) {
            $dn = $compResult.Properties["distinguishedName"][0]

            # Bind ao objeto do computador com credenciais e DC
            $computer = New-Object System.DirectoryServices.DirectoryEntry("LDAP://$SelectedDC/$dn", $user, $pass)

            # Bind à OU de destino com credenciais e DC
            $newParent = New-Object System.DirectoryServices.DirectoryEntry("LDAP://$SelectedDC/$targetOU", $user, $pass)

            # Move o objeto para a nova OU usando MoveTo (sem renomear)
            $computer.MoveTo($newParent)
            $computer.CommitChanges()

            # Mensagem de confirmação
            Log "O computador $computerName foi movido para a OU: $targetOU" "Lime"

            Start-Sleep -Seconds 2

            $progressBar.Value = 80

            # Adiciona ao grupo
            Log "Adicionando '$computerName' no grupo selecionado..." "Cyan"

            # Cria um searcher para o grupo baseado no CN
            $groupSearcher = New-Object System.DirectoryServices.DirectorySearcher
            $groupSearcher.SearchRoot = $root
            $groupSearcher.Filter = "(&(objectCategory=group)(cn=$targetGroupCN))"
            $groupSearcher.SearchScope = "Subtree"
            $groupSearcher.PropertiesToLoad.Add("distinguishedName") | Out-Null

            # Executa a busca pelo grupo
            $groupResult = $groupSearcher.FindOne()

            if ($groupResult -ne $null) {
                $targetGroupDN = $groupResult.Properties["distinguishedName"][0]
                $group = New-Object System.DirectoryServices.DirectoryEntry("LDAP://$SelectedDC/$targetGroupDN", $user, $pass)
                
                try {
                    $group.Invoke("Add", $computer.ADsPath)
                    $group.CommitChanges()
                    Log "O computador $computerName foi adicionado ao grupo: $targetGroupDN" "Lime"
                    Start-Sleep -Seconds 2
                    $progressBar.Value = 100
                }
                catch {
                    $errCode = $_.Exception.HResult
                    if ($errCode -eq -2147016654 -or $_.Exception.Message -like "*0x80071392*" -or $_.Exception.Message -like "*already exists*") {
                        # 0x80071392 = já existe
                        Log "Computador JÁ faz parte do grupo '$targetGroupCN' (ignorando)" "Yellow"
                        Start-Sleep -Seconds 2
                        $progressBar.Value = 100
                    }
                    else {
                        throw $_  # outros erros são reais ? mostra em vermelho
                    }
                }

            } else {
                throw "Grupo com CN '$targetGroupCN' não encontrado no domínio."
            }
        } else {
            throw "Computador $computerName não encontrado no domínio."
        }

     if ($chkRestart.Checked) {
         [System.Windows.Forms.MessageBox]::Show("Tudo feito com sucesso!`nA máquina será reiniciada em 5 segundos.", "Sucesso", 0, 64)
         Start-Sleep -Seconds 5
         Restart-Computer -Force
     } else {
            Log "Reinicie para aplicar totalmente." "Yellow"
            [System.Windows.Forms.MessageBox]::Show("Tudo feito com sucesso!`nReinicie para aplicar totalmente.", "Sucesso", 0, 64)
        }

 } catch {
     Log "ERRO: $($_.Exception.Message)" "Red"
     [System.Windows.Forms.MessageBox]::Show($_.Exception.Message, "Erro", 0, 16)
 } finally {
     $btn.Enabled = $true
     $progressBar.Value = 0
 }
})

Log "Aplicativo iniciado - pronto para uso." "Lime"
$form.ShowDialog()